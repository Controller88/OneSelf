"use strict";(()=>{var e={};e.id=826,e.ids=[826],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9491:e=>{e.exports=require("assert")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},3477:e=>{e.exports=require("querystring")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},1501:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>_,originalPathname:()=>y,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>g});var t={};s.r(t),s.d(t,{GET:()=>GET,PUT:()=>PUT});var a=s(884),n=s(6132),o=s(674),i=s(8617);let u=process.env.SUPABASE_URL,p=process.env.SUPABASE_SERVICE_ROLE_KEY,c=u&&p?(0,i.eI)(u,p):null;async function GET(e){try{let e=await (0,o.getServerSession)();if(!e||!e.user?.id)return new Response(JSON.stringify({error:"N\xe3o autenticado"}),{status:401});if(!c)return new Response(JSON.stringify({error:"Servi\xe7o indispon\xedvel"}),{status:503});let{data:r,error:s}=await c.from("user_preferences").select("*").eq("user_id",e.user.id).single();if(s&&"PGRST116"!==s.code)return console.error("Erro ao buscar prefer\xeancias:",s),new Response(JSON.stringify({error:"Erro ao buscar prefer\xeancias"}),{status:500});return new Response(JSON.stringify({success:!0,preferences:r||{sync_enabled:!0,auto_merge_duplicates:!0,privacy_level:"private"}}),{status:200})}catch(e){return console.error("Erro ao obter prefer\xeancias:",e),new Response(JSON.stringify({error:"Erro ao obter prefer\xeancias"}),{status:500})}}async function PUT(e){try{let r=await (0,o.getServerSession)();if(!r||!r.user?.id)return new Response(JSON.stringify({error:"N\xe3o autenticado"}),{status:401});if(!c)return new Response(JSON.stringify({error:"Servi\xe7o indispon\xedvel"}),{status:503});let s=await e.json(),{data:t,error:a}=await c.from("user_preferences").update({sync_enabled:s.sync_enabled,auto_merge_duplicates:s.auto_merge_duplicates,privacy_level:s.privacy_level,updated_at:new Date().toISOString()}).eq("user_id",r.user.id).select().single();if(a)return console.error("Erro ao atualizar prefer\xeancias:",a),new Response(JSON.stringify({error:"Erro ao atualizar prefer\xeancias"}),{status:500});return new Response(JSON.stringify({success:!0,preferences:t}),{status:200})}catch(e){return console.error("Erro ao atualizar prefer\xeancias:",e),new Response(JSON.stringify({error:"Erro ao atualizar prefer\xeancias"}),{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/user/preferences/route",pathname:"/api/user/preferences",filename:"route",bundlePath:"app/api/user/preferences/route"},resolvedPagePath:"/workspaces/OneSelf/app/api/user/preferences/route.js",nextConfigOutput:"",userland:t}),{requestAsyncStorage:d,staticGenerationAsyncStorage:x,serverHooks:f,headerHooks:_,staticGenerationBailout:g}=l,y="/api/user/preferences/route"}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[657,557,674,617],()=>__webpack_exec__(1501));module.exports=s})();